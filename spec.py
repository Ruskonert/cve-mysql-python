import multiprocessing
import concurrent.futures

class SQLWorker:
    def __init__(self, function):
        self._executor = None
        self._submit = []
        self._function = function

    def initialize(self, worker):
        executor = concurrent.futures.ProcessPoolExecutor(max_workers=worker)
        if executor is not None:
            self._executor = executor
        return self
    
    def as_complete(self):
        return concurrent.futures.as_completed(self._submit)

    def reserve(self, *obj):
        # for test value
        o = obj[0]
        o1 = obj[1]
        o2 = obj[2]
        o3 = obj[3]
        o4 = obj[4]
        o5 = obj[5]
        o6 = obj[6]
        self._submit.append(self._executor.submit(self._function, o, o1, o2, o3, o4, o5, o6))