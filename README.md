# cve-mysql-python
CVE 데이터베이스 구축을 위한 프로그램입니다. MySQL 기반으로 작동합니다.

# Function
해당 통합 플랫폼은 NVD-NIST, ICS-CERT로부터 CVE 리스트들을 읽어들여 데이터베이스로 구축하여 필요한 데이터만을 로드하고 추출하는 데 도움을 줄 수 있습니다.
이것은 다음과 같은 기능을 포함하고 있습니다.

- SQL Database, CSV 파일 추출 지원
- CVE, CPE, Vendor등 Major element 자동 탐색

# Installation
귀하의 컴퓨터에는 MySQL 데이터베이스에 접근할 수 있는 클라이언트가 미리 설치되어 있어야합니다. Python Framework을 기반으로 작동하므로, Python 3 이상의 인터프리터를 요구하며, 해당 모듈을 실행하려면 다음과 같은 명령어가 권장됩니다:<br>
```
git clone https://github.com/ruskonert/cve-mysql-python.git
cd cve-mysql-python
pip install -r requirements.txt
```
아래의 방법은 내장되어 있는 함수를 이용한 방법입니다. 단, 이 방법은 권장하지 않습니다.
```
git clone https://github.com/ruskonert/cve-mysql-python.git
cd cve-mysql-python
python cvemysql.py --setup-install
```

# Command
해당 모듈을 사용하기 전 정의된 명령어는 다음과 같습니다.
```
python cvemysql.py [-type] [-year] [output_file] [--configuration] ...
```

## argument
`[output_file]` 추출된 파일명을 지정합니다. 출력 파일의 이름을 지정하는 것을 강력히 권장합니다. 확장자는 기재하지 않아도 되며, 만약 압축 확장자(.zip)가 붙어있다면, 추출된 파일들을 전부 압축하여 zip 파일로 만들어줍니다.

## Option argument
`[-type]` 데이터베이스 타입을 선택합니다. 현재는 해당 인자를 사용하지 않아도 자동으로 NVD_NIST로 기본 설정되어 있습니다.<br> Available type - nvdnist, icscert (Not support yet)<br>
`[-year]` CVE 리스트 연도를 설정합니다.<br>


## Configuration argument
`[--all]` ICS-CERT, NVD-NIST 데이터베이스로 지정합니다.<br>
`[--year-all]` 모든 연도를 지정합니다. (NVD-NIST 전용)<br>
`[--db]` 데이터베이스 파일로 추출합니다. MySQL 기반에서는 SQL 파일이 기본 확장자입니다.<br>
`[--csv]` 데이터베이스에 있는 데이터 값들을 CSV 파일로 추출합니다.<br>
`[--setup-install]` 처음 실행할 때 모듈이 정상적으로 작동할 수 있도록 합니다. 처음에만 사용이 권장됩니다.<br>

<b>현재, ICS-CERT 타입은 지원하지 않아 `-type` 이나 `--all` 옵션 인자값을 사용해도 NVD-NIST 타입 1개만 사용됩니다.</b><br>
## Example
아래는 해당 플랫폼을 사용하기 위해 입력하는 명령어의 예시들을 나열한 것입니다. 프로그램을 실행시킬 때 참조하시기 바랍니다.<br>
예를 들어 특정 년도의 NVD-NIST CVE 리스트를 모두 가져와서 데이터베이스에 담으려면 다음과 같이 하십시오:
```
python cvemysql.py -year <year>
```

2003년부터 2008년까지의 NVD-NIST CVE 리스트를 데이터베이스에 담고 CSV 파일과 DB로 추출하고 싶다면 다음과 같이 하십시오:
```
python cvesqlite3.py -year 2003-2008 --db --csv "my-cve-list-export"
```

모든 년도의 NVD-NIST CVE 리스트를 데이터베이스에 담고 CSV 파일과 DB로 추출하고 싶다면 다음과 같이 하십시오.
단, 이 경우에는 시간이 오래 걸릴 수 있습니다:
```
python cvesqlite3.py --year-all --db --csv "my-cve-list-export"
```

## 확인된 오류
아래와 같은 메시지가 발생함:
```sql
Already existed the table: 'CREATE TABLE NVD_NIST_XXXX(_number INT PRIMARY KEY AUTO_INCREMENT,CVE VARCHAR(24),CPE VARCHAR(56),Vendor VARCHAR(64),Product VARCHAR(48),Product_name VARCHAR(80),Version VARCHAR(64),Service_Pack VARCHAR(64),Status VARCHAR(10))
````
-  데이터베이스 내 이미 `NVD_NIST_XXXX`라는 이름을 가진 테이블이 존재하여 테이블 생성 함수의 호출이 취소된 것입니다. 단, 해당 프로그램은 이미 존재하는 데이터베이스에 새로운 데이터를 insert하기에 작업을 하기 전에 미리 삭제해두는 것이 좋습니다.
```python
Warning: (1007, "Can't create database 'nvd_nist_xxx'; database exists")
```
- 데이터베이스가 이미 만들어져 데이터베이스 생성 함수의 호출이 취소된 것입니다.
```xml
(Failed insert the element data: <nvdnist.NvdnistHeader object at 0x0FDDDAF0>)
```
- 담으려는 데이터가 테이블의 column 길이보다 길면 발생하는 오류입니다. 이 경우에는 `cve.py` 내  ```default_table(self)```에서 사이즈를 늘려주면 해결됩니다.